---
title: "Invertebrate Taxonomy"
author: "Thomas Sinclair"
date: "06/08/2019"
output: html_document
---

library(tidyverse)
library(here)

#Create a conditional mutate function
```{r}
mutate_cond <- function(.data, condition, ..., envir = parent.frame()) {
  condition <- eval(substitute(condition), .data, envir)
  .data[condition, ] <- .data[condition, ] %>% mutate(...)
  .data
}
```
#Sort out taxonomic names for all sites

#Read in the scenario data
```{r}
newspecies <- read.csv('')
newspecies
```
#newspecies = read.csv(paste("./sites/",sites[i],sep = ""), as.is=TRUE)

#Add in the blank columns
# newspecies[,c("Kingdom",	"Phylum_division",	"Subphylum",	"Superclass",	"Class")] <- NA
# #Rearrange into taxonomic ranking
# newspecies <- newspecies[,c(5:9,1:4)]
#Set up the right column titles
```{r}
ns.clnm <- c("Kingdom",	"Phylum_division",	"Subphylum",	"Superclass",	"Class",	"Order",	"Family",	"Genus",	"Latin")
```
#Convert to lowercase
```{r}
newspecies <- data.frame(tolower(newspecies[,1]),tolower(newspecies[,2]),tolower(newspecies[,3]),tolower(newspecies[,4]),tolower(newspecies[,5]),tolower(newspecies[,6]),tolower(newspecies[,7]),tolower(newspecies[,8]),tolower(newspecies[,9]),stringsAsFactors=FALSE)
colnames(newspecies) <- ns.clnm
```
# Remove accidental spaces
```{r}
newspecies <- mutate_cond(newspecies, Latin == " " & !is.na(Genus), Latin = NA)
newspecies <- mutate_cond(newspecies, Genus == " " & !is.na(Genus), Genus = NA)
newspecies <- mutate_cond(newspecies, Genus == "" & !is.na(Genus), Genus = NA)
```
#Sphaerium poses specific issues
```{r}
newspecies <- mutate_cond(newspecies, Genus == "sphaerium" & !is.na(Genus), Family = "pisidiidae")
newspecies <- mutate_cond(newspecies, Genus == "viviparus" & !is.na(Genus), Family = "viviparidae")
newspecies <- mutate_cond(newspecies, Genus == "hydra" & !is.na(Genus), Family = "hydridae")
newspecies <- mutate_cond(newspecies, Genus == "gillia" & !is.na(Genus), Family = "lithoglyphidae")
newspecies <- mutate_cond(newspecies, Genus == "aplexa" & !is.na(Genus), Family = "physidae")
newspecies <- mutate_cond(newspecies, Genus == "biomphalaria" & !is.na(Genus), Family = "planorbidae")
newspecies <- mutate_cond(newspecies, Genus == "dreissena" & !is.na(Genus), Family = "dreissenidae")
newspecies <- mutate_cond(newspecies, Genus == "ischnura" & !is.na(Genus), Family = "coenagrionidae")
newspecies <- mutate_cond(newspecies, Genus == "tanytarsus" & !is.na(Genus), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Genus == "nemoura" & !is.na(Genus), Family = "nemouridae")
newspecies <- mutate_cond(newspecies, Genus == "agapetus" & !is.na(Genus), Family = "glossosomatidae")
newspecies <- mutate_cond(newspecies, Genus == "anodonta" & !is.na(Genus), Family = "unionidae")
newspecies <- mutate_cond(newspecies, Genus == "asellus" & !is.na(Genus), Family = "asellidae")
newspecies <- mutate_cond(newspecies, Genus == "campeloma" & !is.na(Genus), Family = "viviparidae")
newspecies <- mutate_cond(newspecies, Genus == "ceriodaphnia" & !is.na(Genus), Family = "daphniidae")
newspecies <- mutate_cond(newspecies, Genus == "dero" & !is.na(Genus), Family = "naididae")
newspecies <- mutate_cond(newspecies, Genus == "ecdyonurus" & !is.na(Genus), Family = "heptageniidae")
newspecies <- mutate_cond(newspecies, Genus == "seretella" & !is.na(Genus), Family = "ephemerellidae")
newspecies <- mutate_cond(newspecies, Genus == "goniobasis" & !is.na(Genus), Family = "pleuroceridae")
newspecies <- mutate_cond(newspecies, Genus == "isonychia" & !is.na(Genus), Family = "isonychiidae")
newspecies <- mutate_cond(newspecies, Genus == "lymnaea" & !is.na(Genus), Family = "lymnaeidae")
newspecies <- mutate_cond(newspecies, Genus == "physa" & !is.na(Genus), Family = "physidae")
newspecies <- mutate_cond(newspecies, Genus == "planaria" & !is.na(Genus), Family = "planariidae")
newspecies <- mutate_cond(newspecies, Genus == "polycelis" & !is.na(Genus), Family = "planariidae")
newspecies <- mutate_cond(newspecies, Genus == "rhabditis" & !is.na(Genus), Family = "rhabditidae")
newspecies <- mutate_cond(newspecies, Genus == "rhithrogena" & !is.na(Genus), Family = "heptageniidae")
newspecies <- mutate_cond(newspecies, Genus == "tubifex" & !is.na(Genus), Family = "tubificidae")
newspecies <- mutate_cond(newspecies, Genus == "unio" & !is.na(Genus), Family = "unionidae")
newspecies <- mutate_cond(newspecies, Genus == "elmis" & !is.na(Genus), Family = "elmidae")
newspecies <- mutate_cond(newspecies, Genus == "leuctra" & !is.na(Genus), Family = "leuctridae")
newspecies <- mutate_cond(newspecies, Genus == "aedes" & !is.na(Genus), Family = "culicidae")
newspecies <- mutate_cond(newspecies, Genus == "baetis" & !is.na(Genus), Family = "baetidae")
newspecies <- mutate_cond(newspecies, Genus == "branchiura" & !is.na(Genus), Family = "naididae")
newspecies <- mutate_cond(newspecies, Genus == "chironomus" & !is.na(Genus), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Genus == "culex" & !is.na(Genus), Family = "culicidae")
newspecies <- mutate_cond(newspecies, Genus == "daphnia" & !is.na(Genus), Family = "daphniidae")
newspecies <- mutate_cond(newspecies, Genus == "dugesia" & !is.na(Genus), Family = "dugesiidae")
newspecies <- mutate_cond(newspecies, Genus == "erpobdella" & !is.na(Genus), Family = "erpobdellidae")
newspecies <- mutate_cond(newspecies, Genus == "gammarus" & !is.na(Genus), Family = "gammaridae")
newspecies <- mutate_cond(newspecies, Genus == "hyalella" & !is.na(Genus), Family = "hyalellidae")
newspecies <- mutate_cond(newspecies, Genus == "hydropsyche" & !is.na(Genus), Family = "hydropsychidae")
newspecies <- mutate_cond(newspecies, Genus == "limnodrilus" & !is.na(Genus), Family = "naididae")
newspecies <- mutate_cond(newspecies, Genus == "lumbriculus" & !is.na(Genus), Family = "lumbriculidae")
newspecies <- mutate_cond(newspecies, Genus == "paratanytarsus" & !is.na(Genus), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Genus == "rhyacophila" & !is.na(Genus), Family = "rhyacophilidae")
newspecies <- mutate_cond(newspecies, Genus == "simocephalus" & !is.na(Genus), Family = "daphniidae")
newspecies <- mutate_cond(newspecies, Genus == "hirudo" & !is.na(Genus), Family = "hirudinidae")
newspecies <- mutate_cond(newspecies, Genus == "plectus" & !is.na(Genus), Family = "plectidae")
newspecies <- mutate_cond(newspecies, Genus == "cephalobus" & !is.na(Genus), Family = "cephalobidae")
newspecies <- mutate_cond(newspecies, Genus == "brachionus" & !is.na(Genus), Family = "brachionidae")
newspecies <- mutate_cond(newspecies, Genus == "tylenchus" & !is.na(Genus), Family = "tylenchidae")
newspecies <- mutate_cond(newspecies, Genus == "dorylaimus" & !is.na(Genus), Family = "dorylaimidae")
newspecies <- mutate_cond(newspecies, Genus == "aporcelaimellus" & !is.na(Genus), Family = "aporcelaimidae")
newspecies <- mutate_cond(newspecies, Genus == "tobrilus" & !is.na(Genus), Family = "tobrilidae")
newspecies <- mutate_cond(newspecies, Genus == "helisoma" & !is.na(Genus), Family = "planorbidae")
newspecies <- mutate_cond(newspecies, Genus == "prionchulus" & !is.na(Genus), Family = "mononchidae")
newspecies <- mutate_cond(newspecies, Genus == "mysis" & !is.na(Genus), Family = "mysidae")
newspecies <- mutate_cond(newspecies, Genus == "tanais" & !is.na(Genus), Family = "tanaididae")
newspecies <- mutate_cond(newspecies, Genus == "callibaetis" & !is.na(Genus), Family = "baetidae")
newspecies <- mutate_cond(newspecies, Genus == "philarctus" & !is.na(Genus), Family = "limnephilidae")
newspecies <- mutate_cond(newspecies, Genus == "pteronarcys" & !is.na(Genus), Family = "pteronarcyidae")
newspecies <- mutate_cond(newspecies, Genus == "streptocephalus" & !is.na(Genus), Family = "streptocephalidae")
newspecies <- mutate_cond(newspecies, Genus == "pontoporeia" & !is.na(Genus), Family = "pontoporeiidae")
newspecies <- mutate_cond(newspecies, Genus == "deleatidium" & !is.na(Genus), Family = "leptophlebiidae")
newspecies <- mutate_cond(newspecies, Genus == "mesocyclops" & !is.na(Genus), Family = "cyclopidae")
newspecies <- mutate_cond(newspecies, Genus == "boeckella" & !is.na(Genus), Family = "centropagidae")
newspecies <- mutate_cond(newspecies, Genus == "calamoecia" & !is.na(Genus), Family = "centropagidae")
newspecies <- mutate_cond(newspecies, Genus == "parastenocaris" & !is.na(Genus), Family = "parastenocarididae")
newspecies <- mutate_cond(newspecies, Genus == "acroneuria" & !is.na(Genus), Family = "perlidae")
newspecies <- mutate_cond(newspecies, Genus == "alona" & !is.na(Genus), Family = "chydoridae")
newspecies <- mutate_cond(newspecies, Genus == "amnicola" & !is.na(Genus), Family = "amnicolidae")
newspecies <- mutate_cond(newspecies, Genus == "utterbackia" & !is.na(Genus), Family = "unionidae")
newspecies <- mutate_cond(newspecies, Genus == "cherax" & !is.na(Genus), Family = "parastacidae")
newspecies <- mutate_cond(newspecies, Genus == "corbicula" & !is.na(Genus), Family = "corbiculidae")
newspecies <- mutate_cond(newspecies, Genus == "crangonyx" & !is.na(Genus), Family = "crangonyctidae")
newspecies <- mutate_cond(newspecies, Genus == "cypris" & !is.na(Genus), Family = "cyprididae")
newspecies <- mutate_cond(newspecies, Genus == "echinogammarus" & !is.na(Genus), Family = "gammaridae")
newspecies <- mutate_cond(newspecies, Genus == "juga" & !is.na(Genus), Family = "pleuroceridae")
newspecies <- mutate_cond(newspecies, Genus == "gyraulus" & !is.na(Genus), Family = "planorbidae")
newspecies <- mutate_cond(newspecies, Genus == "macrobrachium" & !is.na(Genus), Family = "palaemonidae")
newspecies <- mutate_cond(newspecies, Genus == "moina" & !is.na(Genus), Family = "moinidae")
newspecies <- mutate_cond(newspecies, Genus == "nais" & !is.na(Genus), Family = "naididae")
newspecies <- mutate_cond(newspecies, Genus == "orconectes" & !is.na(Genus), Family = "cambaridae")
newspecies <- mutate_cond(newspecies, Genus == "paratya" & !is.na(Genus), Family = "atyidae")
newspecies <- mutate_cond(newspecies, Genus == "pectinatella" & !is.na(Genus), Family = "pectinatellidae")
newspecies <- mutate_cond(newspecies, Genus == "philodina" & !is.na(Genus), Family = "philodinidae")
newspecies <- mutate_cond(newspecies, Genus == "tropocyclops" & !is.na(Genus), Family = "cyclopidae")
newspecies <- mutate_cond(newspecies, Genus == "anisops" & !is.na(Genus), Family = "notonectidae")
newspecies <- mutate_cond(newspecies, Genus == "anopheles" & !is.na(Genus), Family = "culicidae")
newspecies <- mutate_cond(newspecies, Genus == "belostoma" & !is.na(Genus), Family = "belostomatidae")
newspecies <- mutate_cond(newspecies, Genus == "berosus" & !is.na(Genus), Family = "hydrophilidae")
newspecies <- mutate_cond(newspecies, Genus == "chaoborus" & !is.na(Genus), Family = "chaoboridae")
newspecies <- mutate_cond(newspecies, Genus == "claassenia" & !is.na(Genus), Family = "perlidae")
newspecies <- mutate_cond(newspecies, Genus == "cloeon" & !is.na(Genus), Family = "baetidae")
newspecies <- mutate_cond(newspecies, Genus == "corixa" & !is.na(Genus), Family = "corixidae")
newspecies <- mutate_cond(newspecies, Genus == "cricotopus" & !is.na(Genus), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Genus == "crocothemis" & !is.na(Genus), Family = "libellulidae")
newspecies <- mutate_cond(newspecies, Genus == "culicoides" & !is.na(Genus), Family = "ceratopogonidae")
newspecies <- mutate_cond(newspecies, Genus == "culiseta" & !is.na(Genus), Family = "culicidae")
newspecies <- mutate_cond(newspecies, Genus == "cyprinotus" & !is.na(Genus), Family = "cyprididae")
newspecies <- mutate_cond(newspecies, Genus == "dicrotendipes" & !is.na(Genus), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Genus == "ephemerella" & !is.na(Genus), Family = "ephemerellidae")
newspecies <- mutate_cond(newspecies, Genus == "glyptotendipes" & !is.na(Genus), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Genus == "hydrophilus" & !is.na(Genus), Family = "hydrophilidae")
newspecies <- mutate_cond(newspecies, Genus == "hygrotus" & !is.na(Genus), Family = "dytiscidae")
newspecies <- mutate_cond(newspecies, Genus == "laccophilus" & !is.na(Genus), Family = "dytiscidae")
newspecies <- mutate_cond(newspecies, Genus == "neomysis" & !is.na(Genus), Family = "mysidae")
newspecies <- mutate_cond(newspecies, Genus == "neoplea" & !is.na(Genus), Family = "pleidae")
newspecies <- mutate_cond(newspecies, Genus == "notonecta" & !is.na(Genus), Family = "notonectidae")
newspecies <- mutate_cond(newspecies, Genus == "peltodytes" & !is.na(Genus), Family = "haliplidae")
newspecies <- mutate_cond(newspecies, Genus == "procladius" & !is.na(Genus), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Genus == "pseudagrion" & !is.na(Genus), Family = "coenagrionidae")
newspecies <- mutate_cond(newspecies, Genus == "pteronarcella" & !is.na(Genus), Family = "pteronarcyidae")
newspecies <- mutate_cond(newspecies, Genus == "simulium" & !is.na(Genus), Family = "simuliidae")
newspecies <- mutate_cond(newspecies, Genus == "thermonectus" & !is.na(Genus), Family = "dytiscidae")
newspecies <- mutate_cond(newspecies, Genus == "toxorhynchites" & !is.na(Genus), Family = "culicidae")
newspecies <- mutate_cond(newspecies, Genus == "triops" & !is.na(Genus), Family = "triopsidae")
newspecies <- mutate_cond(newspecies, Genus == "tropisternus" & !is.na(Genus), Family = "hydrophilidae")
newspecies <- mutate_cond(newspecies, Genus == "austrolestes" & !is.na(Genus), Family = "lestidae")
newspecies <- mutate_cond(newspecies, Genus == "lophopodella" & !is.na(Genus), Family = "lophopodidae")
newspecies <- mutate_cond(newspecies, Genus == "plumatella" & !is.na(Genus), Family = "plumatellidae")
newspecies <- mutate_cond(newspecies, Genus == "procambarus" & !is.na(Genus), Family = "cambaridae")
```

#replace all chironomus data with just the chironomus family
```{r}
newspecies <- mutate_cond(newspecies, Family == "tanypodinae [sub-family]" & !is.na(Family), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Family == "diamesinae [sub-family]" & !is.na(Family), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Family == "prodiamesinae [sub-family]" & !is.na(Family), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Family == "orthocladiinae [sub-family]" & !is.na(Family), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Family == "chironomini [tribe]" & !is.na(Family), Family = "chironomidae")
newspecies <- mutate_cond(newspecies, Family == "tanytarsini [tribe]" & !is.na(Family), Family = "chironomidae")
```
#Start with families
```{r}
newspecies <- mutate_cond(newspecies, Family == "lophopodidae" & !is.na(Family), Order = "plumatellida")
newspecies <- mutate_cond(newspecies, Family == "plumatellidae" & !is.na(Family), Order = "plumatellida")
newspecies <- mutate_cond(newspecies, Family == "philodinidae" & !is.na(Family), Order = "philodinida")
newspecies <- mutate_cond(newspecies, Family == "cambaridae" & !is.na(Family), Order = "decapoda")
newspecies <- mutate_cond(newspecies, Family == "lestidae" & !is.na(Family), Order = "odonata")
newspecies <- mutate_cond(newspecies, Family == "unionidae" & !is.na(Family), Order = "unionoida")
newspecies <- mutate_cond(newspecies, Family == "tubificidae" & !is.na(Family), Order = "haplotaxida")
newspecies <- mutate_cond(newspecies, Family == "hydrobiidae" & !is.na(Family), Order = "neotaenioglossa")
newspecies <- mutate_cond(newspecies, Family == "lymnaeidae" & !is.na(Family), Order = "basommatophora")
newspecies <- mutate_cond(newspecies, Family == "perlidae" & !is.na(Family), Order = "plecoptera")
newspecies <- mutate_cond(newspecies, Family == "coenagrionidae" & !is.na(Family), Order = "odonata")
newspecies <- mutate_cond(newspecies, Family == "gerridae" & !is.na(Family), Order = "heteroptera")
newspecies <- mutate_cond(newspecies, Family == "corixidae" & !is.na(Family), Order = "heteroptera")
newspecies <- mutate_cond(newspecies, Family == "sialidae" & !is.na(Family), Order = "megaloptera")
newspecies <- mutate_cond(newspecies, Family == "nemouridae" & !is.na(Family), Order = "plecoptera")
newspecies <- mutate_cond(newspecies, Family == "taeniopterygidae" & !is.na(Family), Order = "plecoptera")
newspecies <- mutate_cond(newspecies, Family == "haliplidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "limnephilidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "hydropsychidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "ceratopogonidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "simuliidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "chironomidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "planariidae" & !is.na(Family), Order = "tricladida")
newspecies <- mutate_cond(newspecies, Family == "sphaeriidae" & !is.na(Family), Order = "veneroida")
newspecies <- mutate_cond(newspecies, Family == "lumbriculidae" & !is.na(Family), Order = "lumbriculida")
newspecies <- mutate_cond(newspecies, Family == "enchytraeidae" & !is.na(Family), Order = "haplotaxida")
newspecies <- mutate_cond(newspecies, Family == "naididae" & !is.na(Family), Order = "haplotaxida")
newspecies <- mutate_cond(newspecies, Family == "lumbricidae" & !is.na(Family), Order = "lumbriculida")
newspecies <- mutate_cond(newspecies, Family == "glossiphoniidae" & !is.na(Family), Order = "rhynchobdellida")
newspecies <- mutate_cond(newspecies, Family == "milnesiidae" & !is.na(Family), Order = "apochela")
newspecies <- mutate_cond(newspecies, Family == "hygrobatidae" & !is.na(Family), Order = "trombidiformes")
newspecies <- mutate_cond(newspecies, Family == "gammaridae" & !is.na(Family), Order = "amphipoda")
newspecies <- mutate_cond(newspecies, Family == "baetidae" & !is.na(Family), Order = "ephemeroptera")
newspecies <- mutate_cond(newspecies, Family == "heptageniidae" & !is.na(Family), Order = "ephemeroptera")
newspecies <- mutate_cond(newspecies, Family == "leptophlebiidae" & !is.na(Family), Order = "ephemeroptera")
newspecies <- mutate_cond(newspecies, Family == "ephemeridae" & !is.na(Family), Order = "ephemeroptera")
newspecies <- mutate_cond(newspecies, Family == "ephemerellidae" & !is.na(Family), Order = "ephemeroptera")
newspecies <- mutate_cond(newspecies, Family == "isonychiidae" & !is.na(Family), Order = "ephemeroptera")
newspecies <- mutate_cond(newspecies, Family == "caenidae" & !is.na(Family), Order = "ephemeroptera")
newspecies <- mutate_cond(newspecies, Family == "leuctridae" & !is.na(Family), Order = "plecoptera")
newspecies <- mutate_cond(newspecies, Family == "perlodidae" & !is.na(Family), Order = "plecoptera")
newspecies <- mutate_cond(newspecies, Family == "hydraenidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "elmidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "rhyacophilidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "glossosomatidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "polycentropodidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "lepidostomatidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "sericostomatidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "limoniidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "pediciidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "empididae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "chloroperlidae" & !is.na(Family), Order = "odonata")
newspecies <- mutate_cond(newspecies, Family == "calopterygidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "gyrinidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "goeridae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "athericidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "lebertiidae" & !is.na(Family), Order = "trombidiformes")
newspecies <- mutate_cond(newspecies, Family == "hydroptilidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "philopotamidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "odontoceridae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "dixidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "erpobdellidae" & !is.na(Family), Order = "arhynchobdellida")
newspecies <- mutate_cond(newspecies, Family == "brachycentridae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "tabanidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "asellidae" & !is.na(Family), Order = "isopoda")
newspecies <- mutate_cond(newspecies, Family == "veliidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "dytiscidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "helophoridae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "cordulegastridae" & !is.na(Family), Order = "odonata")
newspecies <- mutate_cond(newspecies, Family == "planorbidae" & !is.na(Family), Order = "basommatophora", Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Family == "beraeidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "crangonyctidae" & !is.na(Family), Order = "amphipoda")
newspecies <- mutate_cond(newspecies, Family == "tipulidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "neritidae" & !is.na(Family), Order = "archeogastropoda", Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Family == "bithyniidae" & !is.na(Family), Order = "littorinimorpha")
newspecies <- mutate_cond(newspecies, Family == "piscicolidae" & !is.na(Family), Order = "rhynchobdellida")
newspecies <- mutate_cond(newspecies, Family == "aphelocheiridae" & !is.na(Family), Order = "hemiptera")
newspecies <- mutate_cond(newspecies, Family == "psychodidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "scirtidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "ptychopteridae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "stratiomyidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "valvatidae" & !is.na(Family), Order = "mesogastropoda", Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Family == "pleuroceridae" & !is.na(Family), Order = "neotaenioglossa", Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Family == "psychomyiidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "spongillidae" & !is.na(Family), Order = "demospongea")
newspecies <- mutate_cond(newspecies, Family == "dugesiidae" & !is.na(Family), Order = "tricladida")
newspecies <- mutate_cond(newspecies, Family == "dendrocoelidae" & !is.na(Family), Order = "tricladida")
newspecies <- mutate_cond(newspecies, Family == "siphlonuridae" & !is.na(Family), Order = "ephemeroptera")
newspecies <- mutate_cond(newspecies, Family == "dolichopodidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "muscidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "sperchontidae" & !is.na(Family), Order = "trombidiformes")
newspecies <- mutate_cond(newspecies, Family == "physidae" & !is.na(Family), Order = "basommatophora", Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Family == "haplotaxidae" & !is.na(Family), Order = "haplotaxida")
newspecies <- mutate_cond(newspecies, Family == "acroloxidae" & !is.na(Family), Order = "basommatophora", Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Family == "molannidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "astacidae" & !is.na(Family), Order = "decapoda")
newspecies <- mutate_cond(newspecies, Family == "sisyridae" & !is.na(Family), Order = "neuroptera")
newspecies <- mutate_cond(newspecies, Family == "zonitidae" & !is.na(Family), Order = "stylommatophora", Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Family == "niphargidae" & !is.na(Family), Order = "amphipoda")
newspecies <- mutate_cond(newspecies, Family == "succineidae" & !is.na(Family), Order = "stylommatophora", Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Family == "hydrodromidae" & !is.na(Family), Order = "trombidiformes")
newspecies <- mutate_cond(newspecies, Family == "eylaidae" & !is.na(Family), Order = "trombidiformes")
newspecies <- mutate_cond(newspecies, Family == "limnesiidae" & !is.na(Family), Order = "trombidiformes")
newspecies <- mutate_cond(newspecies, Family == "unionicolidae" & !is.na(Family), Order = "trombidiformes")
newspecies <- mutate_cond(newspecies, Family == "hydrophilidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "viviparidae" & !is.na(Family), Order = "mesogastropoda", Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Family == "ecnomidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "corophiidae" & !is.na(Family), Order = "amphipoda")
newspecies <- mutate_cond(newspecies, Family == "hydridae" & !is.na(Family), Order = "hydroida")
newspecies <- mutate_cond(newspecies, Family == "hydryphantidae" & !is.na(Family), Order = "trombidiformes")
newspecies <- mutate_cond(newspecies, Family == "ephydridae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "hirudinidae" & !is.na(Family), Order = "arhynchobdellida")
newspecies <- mutate_cond(newspecies, Family == "phryganeidae" & !is.na(Family), Order = "trichoptera")
newspecies <- mutate_cond(newspecies, Family == "nepidae" & !is.na(Family), Order = "hemiptera")
newspecies <- mutate_cond(newspecies, Family == "dryopidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "hydrachnidae" & !is.na(Family), Order = "trombidiformes")
newspecies <- mutate_cond(newspecies, Family == "ameletidae" & !is.na(Family), Order = "ephemeroptera")
newspecies <- mutate_cond(newspecies, Family == "capniidae" & !is.na(Family), Order = "plecoptera")
newspecies <- mutate_cond(newspecies, Family == "arrenuridae" & !is.na(Family), Order = "trombidiformes")
newspecies <- mutate_cond(newspecies, Family == "thaumaleidae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "torrenticolidae" & !is.na(Family), Order = "trombidiformes")  
newspecies <- mutate_cond(newspecies, Family == "hydrometridae" & !is.na(Family), Order = "hemiptera")
newspecies <- mutate_cond(newspecies, Family == "notonectidae" & !is.na(Family), Order = "heteroptera")
newspecies <- mutate_cond(newspecies, Family == "pyralidae" & !is.na(Family), Order = "lepidoptera")
newspecies <- mutate_cond(newspecies, Family == "potamanthidae" & !is.na(Family), Order = "ephemeroptera")
newspecies <- mutate_cond(newspecies, Family == "chordodidae" & !is.na(Family), Order = "gordioida")
newspecies <- mutate_cond(newspecies, Family == "aeshnidae" & !is.na(Family), Order = "odonata")
newspecies <- mutate_cond(newspecies, Family == "noteridae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "naucoridae" & !is.na(Family), Order = "heteroptera")
newspecies <- mutate_cond(newspecies, Family == "gomphidae" & !is.na(Family), Order = "odonata")
newspecies <- mutate_cond(newspecies, Family == "platycnemididae" & !is.na(Family), Order = "odonata")
newspecies <- mutate_cond(newspecies, Family == "chrysomelidae" & !is.na(Family), Order = "coleoptera")
newspecies <- mutate_cond(newspecies, Family == "osmylidae" & !is.na(Family), Order = "neuroptera")
newspecies <- mutate_cond(newspecies, Family == "pisidiidae" & !is.na(Family), Order = "veneroida")
newspecies <- mutate_cond(newspecies, Family == "leptodoridae" & !is.na(Family), Order = "cladocera")
newspecies <- mutate_cond(newspecies, Family == "daphniidae" & !is.na(Family), Order = "diplostraca")
newspecies <- mutate_cond(newspecies, Family == "margaritiferidae" & !is.na(Family), Order = "unionoida")
newspecies <- mutate_cond(newspecies, Family == "chaoboridae" & !is.na(Family), Order = "diptera")
newspecies <- mutate_cond(newspecies, Family == "teutoniidae" & !is.na(Family), Order = "trombidiformes")
newspecies <- mutate_cond(newspecies, Family == "rhabditidae" & !is.na(Family), Order = "rhabditida")
newspecies <- mutate_cond(newspecies, Family == "culicidae" & !is.na(Family), Order = "diptera") 
newspecies <- mutate_cond(newspecies, Family == "hyalellidae" & !is.na(Family), Order = "amphipoda") 
newspecies <- mutate_cond(newspecies, Family == "plectidae" & !is.na(Family), Order = "plectida")
newspecies <- mutate_cond(newspecies, Family == "cephalobidae" & !is.na(Family), Order = "rhabditida")
newspecies <- mutate_cond(newspecies, Family == "brachionidae" & !is.na(Family), Order = "ploima")
newspecies <- mutate_cond(newspecies, Family == "tylenchidae" & !is.na(Family), Order = "tylenchida")
newspecies <- mutate_cond(newspecies, Family == "dorylaimidae" & !is.na(Family), Order = "dorylaimida")
newspecies <- mutate_cond(newspecies, Family == "aporcelaimidae" & !is.na(Family), Order = "dorylaimida")
newspecies <- mutate_cond(newspecies, Family == "tobrilidae" & !is.na(Family), Order = "triplonchida")
newspecies <- mutate_cond(newspecies, Family == "mononchidae" & !is.na(Family), Order = "mononchida")
newspecies <- mutate_cond(newspecies, Family == "mysidae" & !is.na(Family), Order = "mysida")
newspecies <- mutate_cond(newspecies, Family == "tanaididae" & !is.na(Family), Order = "tanaidacea")
newspecies <- mutate_cond(newspecies, Family == "pteronarcyidae" & !is.na(Family), Order = "plecoptera")
newspecies <- mutate_cond(newspecies, Family == "streptocephalidae" & !is.na(Family), Order = "anostraca")
newspecies <- mutate_cond(newspecies, Family == "pontoporeiidae" & !is.na(Family), Order = "amphipoda")
newspecies <- mutate_cond(newspecies, Family == "cyclopidae" & !is.na(Family), Order = "cyclopoida")
newspecies <- mutate_cond(newspecies, Family == "centropagidae" & !is.na(Family), Order = "calanoida")
newspecies <- mutate_cond(newspecies, Family == "parastenocarididae" & !is.na(Family), Order = "harpacticoida")
newspecies <- mutate_cond(newspecies, Family == "chydoridae" & !is.na(Family), Order = "diplostraca")
newspecies <- mutate_cond(newspecies, Family == "amnicolidae" & !is.na(Family), Order = "littorinimorpha")
newspecies <- mutate_cond(newspecies, Family == "parastacidae" & !is.na(Family), Order = "decapoda")
newspecies <- mutate_cond(newspecies, Family == "cyrenidae" & !is.na(Family), Order = "veneroida")
newspecies <- mutate_cond(newspecies, Family == "cyprididae" & !is.na(Family), Order = "podocopida")
newspecies <- mutate_cond(newspecies, Family == "semisulcospiridae" & !is.na(Family), class = "gastropoda")
newspecies <- mutate_cond(newspecies, Family == "palaemonidae" & !is.na(Family), Order = "decapoda")
newspecies <- mutate_cond(newspecies, Family == "moinidae" & !is.na(Family), Order = "cladocera")
newspecies <- mutate_cond(newspecies, Family == "cambaridae" & !is.na(Family), Order = "decapoda")
newspecies <- mutate_cond(newspecies, Family == "atyidae" & !is.na(Family), Order = "decapoda")
newspecies <- mutate_cond(newspecies, Family == "pectinatellidae" & !is.na(Family), Order = "plumatellida")
newspecies <- mutate_cond(newspecies, Family == "belostomatidae" & !is.na(Family), Order = "hemiptera")
newspecies <- mutate_cond(newspecies, Family == "libellulidae" & !is.na(Family), Order = "odonata")
newspecies <- mutate_cond(newspecies, Family == "pleidae" & !is.na(Family), Order = "hemiptera")
newspecies <- mutate_cond(newspecies, Family == "triopsidae" & !is.na(Family), Order = "notostraca")
newspecies <- mutate_cond(newspecies, Family == "corbiculidae" & !is.na(Family), Order = "veneroida")
newspecies <- mutate_cond(newspecies, Family == "lithoglyphidae" & !is.na(Family), Order = "littorinimorpha")
newspecies <- mutate_cond(newspecies, Family == "dreissenidae" & !is.na(Family), Order = "veneroida")
```
#Snails pose some issues
```{r}
newspecies <- mutate_cond(newspecies, Family == "semisulcospiridae" & !is.na(Family), Class = "gastropoda")
```
#Orders set classes
```{r}
newspecies <- mutate_cond(newspecies, Order == "haplotaxida" & !is.na(Order), Class = "oligochaeta") #family hydropsychidae
newspecies <- mutate_cond(newspecies, Order == "amphipoda" & !is.na(Order), Class = "malacostraca")
newspecies <- mutate_cond(newspecies, Order == "diplostraca" & !is.na(Order), Class = "branchiopoda")
newspecies <- mutate_cond(newspecies, Order == "tricladida" & !is.na(Order), Class = "turbellaria")
newspecies <- mutate_cond(newspecies, Order == "neotaenioglossa" & !is.na(Order), Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Order == "veneroida" & !is.na(Order), Class = "bivalvia")
newspecies <- mutate_cond(newspecies, Order == "lumbriculida" & !is.na(Order), Class = "clitellata")
newspecies <- mutate_cond(newspecies, Order == "rhynchobdellida" & !is.na(Order), Class = "clitellata") 
newspecies <- mutate_cond(newspecies, Order == "apochela" & !is.na(Order), Class = "eutardigrada")
newspecies <- mutate_cond(newspecies, Order == "trombidiformes" & !is.na(Order), Class = "arachnida")
newspecies <- mutate_cond(newspecies, Order == "ephemeroptera" & !is.na(Order), Class = "insecta")
newspecies <- mutate_cond(newspecies, Order == "plecoptera" & !is.na(Order), Class = "insecta")
newspecies <- mutate_cond(newspecies, Order == "coleoptera" & !is.na(Order), Class = "insecta")
newspecies <- mutate_cond(newspecies, Order == "trichoptera" & !is.na(Order), Class = "insecta")
newspecies <- mutate_cond(newspecies, Order == "diptera" & !is.na(Order), Class = "insecta")
newspecies <- mutate_cond(newspecies, Order == "hemiptera" & !is.na(Order), Class = "insecta")
newspecies <- mutate_cond(newspecies, Order == "odonata" & !is.na(Order), Class = "insecta")
newspecies <- mutate_cond(newspecies, Order == "basommatophora" & !is.na(Order), Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Order == "arhynchobdellida" & !is.na(Order), Class = "clitellata")
newspecies <- mutate_cond(newspecies, Order == "isopoda" & !is.na(Order), Class = "malacostraca")
newspecies <- mutate_cond(newspecies, Order == "heteroptera" & !is.na(Order), Class = "insecta")
newspecies <- mutate_cond(newspecies, Order == "megaloptera" & !is.na(Order), Class = "insecta")
newspecies <- mutate_cond(newspecies, Order == "littorinimorpha" & !is.na(Order), Class = "gastropoda")
newspecies <- mutate_cond(newspecies, Order == "demospongea" & !is.na(Order), Class = "demospongiae")
newspecies <- mutate_cond(newspecies, Order == "decapoda" & !is.na(Order), Class = "malacostraca")
newspecies <- mutate_cond(newspecies, Order == "neuroptera" & !is.na(Order), Class = "insecta")
newspecies <- mutate_cond(newspecies, Order == "unionoida" & !is.na(Order), Class = "bivalvia")
newspecies <- mutate_cond(newspecies, Order == "hydroida" & !is.na(Order), Class = "hydrozoa")
newspecies <- mutate_cond(newspecies, Order == "lepidoptera" & !is.na(Order), Class = "insecta")
newspecies <- mutate_cond(newspecies, Order == "gordioida" & !is.na(Order), Class = "chordodea")
newspecies <- mutate_cond(newspecies, Order == "cladocera" & !is.na(Order), Class = "branchiopoda")
newspecies <- mutate_cond(newspecies, Order == "rhabditida" & !is.na(Order), Class = "secernentea")
newspecies <- mutate_cond(newspecies, Order == "plectida" & !is.na(Order), Class = "chromadorea")
newspecies <- mutate_cond(newspecies, Order == "ploima" & !is.na(Order), Class = "eurotatoria")
newspecies <- mutate_cond(newspecies, Order == "tylenchida" & !is.na(Order), Class = "secernentea")
newspecies <- mutate_cond(newspecies, Order == "dorylaimida" & !is.na(Order), Class = "enoplea")
newspecies <- mutate_cond(newspecies, Order == "triplonchida" & !is.na(Order), Class = "enoplea")
newspecies <- mutate_cond(newspecies, Order == "mononchida" & !is.na(Order), Class = "enoplea")
newspecies <- mutate_cond(newspecies, Order == "mysida" & !is.na(Order), Class = "malacostraca")
newspecies <- mutate_cond(newspecies, Order == "tanaidacea" & !is.na(Order), Class = "malacostraca")
newspecies <- mutate_cond(newspecies, Order == "anostraca" & !is.na(Order), Class = "branchiopoda")
newspecies <- mutate_cond(newspecies, Order == "cyclopoida" & !is.na(Order), Class = "maxillopoda")
newspecies <- mutate_cond(newspecies, Order == "calanoida" & !is.na(Order), Class = "maxillopoda")
newspecies <- mutate_cond(newspecies, Order == "harpacticoida" & !is.na(Order), Class = "maxillopoda")
newspecies <- mutate_cond(newspecies, Order == "podocopida" & !is.na(Order), Class = "ostracoda")
newspecies <- mutate_cond(newspecies, Order == "plumatellida" & !is.na(Order), Class = "phylactolaemata")
newspecies <- mutate_cond(newspecies, Order == "notostraca" & !is.na(Order), Class = "branchiopoda")
newspecies <- mutate_cond(newspecies, Order == "philodinida" & !is.na(Order), Class = "bdelloidea")
```
#Class for phylum_division,	subphylum and superclass
```{r}
newspecies <- mutate_cond(newspecies, Class == "bivalvia" & !is.na(Class), Class = "bivalvia", Phylum_division = "mollusca", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "insecta" & !is.na(Class), Subphylum = "hexapoda", Phylum_division = "arthropoda", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "malacostraca" & !is.na(Class), Subphylum = "crustacea", Phylum_division = "arthropoda", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "gastropoda" & !is.na(Class), Phylum_division = "mollusca", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "clitellata" & !is.na(Class), Phylum_division = "annelida", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "oligochaeta" & !is.na(Class), Phylum_division = "annelida", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "eutardigrada" & !is.na(Class), Phylum_division = "tardigrada", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "arachnida" & !is.na(Class), Phylum_division = "arthropoda", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "turbellaria" & !is.na(Class), Phylum_division = "platyhelminthes", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "demospongiae" & !is.na(Class), Phylum_division = "porifera", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "hydrozoa" & !is.na(Class), Phylum_division = "cnidaria", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "chordodea" & !is.na(Class), Phylum_division = "nematomorpha", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "branchiopoda" & !is.na(Class), Subphylum = "crustacea", Phylum_division = "arthropoda", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "secernentea" & !is.na(Class), Class = "secernentea", Phylum_division = "nematoda", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "chromadorea" & !is.na(Class), Phylum_division = "nematoda", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "eurotatoria" & !is.na(Class), Phylum_division = "rotifera", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "enoplea" & !is.na(Class), Phylum_division = "nematoda", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "malacostraca" & !is.na(Class), Subphylum = "crustacea", Phylum_division = "arthropoda", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "maxillopoda" & !is.na(Class), Subphylum = "crustacea", Phylum_division = "arthropoda", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "ostracoda" & !is.na(Class), Subphylum = "crustacea", Phylum_division = "arthropoda", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "phylactolaemata" & !is.na(Class), Phylum_division = "bryozoa", Kingdom = "animalia")
newspecies <- mutate_cond(newspecies, Class == "bdelloidea" & !is.na(Class), Phylum_division = "rotifera", Kingdom = "animalia")
```
#Save the file while removing all repeats
```{r}
write.csv(unique(newspecies),file=(''))
```
